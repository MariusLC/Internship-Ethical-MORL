
 86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                     | 71/83 [00:01<00:00, 48.71it/s]/home/lechapelier/Documents/Stage M2/Internship-Ethical-MORL/moral_rl/moral/ppo.py:49: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  ../torch/csrc/utils/tensor_new.cpp:210.)
  trajectory_states = torch.tensor(tau['states']).float().to(device)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 83/83 [00:20<00:00,  4.11it/s]

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 83/83 [00:19<00:00,  4.28it/s]
Traceback (most recent call last):
  File "/usr/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/lechapelier/Documents/Stage M2/Internship-Ethical-MORL/moral_rl/moral/complete_moral_train.py", line 63, in <module>
    generate_demos_n_experts(nb_experts, nb_demos, env, env_rad, lambd_str_list, ppo_filenames, demo_path, model_path, model_ext, demo_ext)
  File "/home/lechapelier/Documents/Stage M2/Internship-Ethical-MORL/moral_rl/utils/generate_demos_not_main.py", line 17, in generate_demos_n_experts
    generate_demos_1_expert(nb_demos, env_rad+env, demos_filename, ppo_filename)
  File "/home/lechapelier/Documents/Stage M2/Internship-Ethical-MORL/moral_rl/utils/generate_demos_not_main.py", line 42, in generate_demos_1_expert
    for t in tqdm(range((max_steps-1)*nb_demos)):
NameError: name 'max_steps' is not defined