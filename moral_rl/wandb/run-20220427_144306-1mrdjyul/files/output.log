 83%|████████████████████████████████████████████▉         | 69/83 [00:01<00:00, 73.20it/s]/home/lechapelier/Documents/Stage M2/Internship-Ethical-MORL/moral_rl/moral/ppo.py:49: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  ../torch/csrc/utils/tensor_new.cpp:210.)
  trajectory_states = torch.tensor(tau['states']).float().to(device)
100%|██████████████████████████████████████████████████████| 83/83 [00:11<00:00,  7.41it/s]
100%|██████████████████████████████████████████████████████| 83/83 [00:10<00:00,  7.83it/s]
  0%|                                                             | 0/7400 [00:00<?, ?it/s][W NNPACK.cpp:51] Could not initialize NNPACK! Reason: Unsupported hardware.






100%|█████████████████████████████████████████████████| 7400/7400 [00:13<00:00, 564.53it/s]






100%|█████████████████████████████████████████████████| 7400/7400 [00:13<00:00, 565.88it/s]
  0%|                                                               | 0/83 [00:00<?, ?it/s]

 88%|███████████████████████████████████████████████▍      | 73/83 [00:10<00:01,  6.69it/s]
Traceback (most recent call last):
  File "/usr/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/lechapelier/Documents/Stage M2/Internship-Ethical-MORL/moral_rl/moral/complete_moral_train.py", line 66, in <module>
    airl_train_n_experts(nb_experts, env, env_rad, lambd_str_list, ppo_filenames, discriminator_filenames, demo_path, model_path, model_ext, demo_ext)
  File "/home/lechapelier/Documents/Stage M2/Internship-Ethical-MORL/moral_rl/moral/airl_train_not_main.py", line 22, in airl_train_n_experts
    airl_train_1_expert(env_rad+env, demos_filename, discrim_filename)
  File "/home/lechapelier/Documents/Stage M2/Internship-Ethical-MORL/moral_rl/moral/airl_train_not_main.py", line 106, in airl_train_1_expert
    batch_size=config.batchsize_discriminator)
  File "/home/lechapelier/.local/lib/python3.9/site-packages/wandb/sdk/wandb_config.py", line 163, in __getattr__
    return self.__getitem__(key)
  File "/home/lechapelier/.local/lib/python3.9/site-packages/wandb/sdk/wandb_config.py", line 131, in __getitem__
    return self._items[key]
KeyError: 'batchsize_discriminator'